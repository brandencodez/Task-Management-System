<div class="container">
  <div class="page-header">
    <h2>Employee Management</h2>
    <button class="btn btn-primary" (click)="toggleAddForm()">
      {{ showAddForm ? 'Cancel' : 'Add Employee' }}
    </button>
  </div>

  <!-- Add/Edit Form -->
  @if (showAddForm) {
    <div class="card form-card">
      <h3>{{ editingEmployee ? 'Edit Employee' : 'Add New Employee' }}</h3>
      <form (ngSubmit)="editingEmployee ? updateEmployee() : addEmployee()" class="form-grid">
        <div class="form-group">
          <label class="form-label">Name *</label>
          <input 
            type="text" 
            [(ngModel)]="newEmployee.name" 
            name="name" 
            required 
            class="form-control"
            placeholder="Enter employee name"
          >
        </div>

        <div class="form-group">
          <label class="form-label">Email *</label>
          <input 
            type="email" 
            [(ngModel)]="newEmployee.email" 
            name="email" 
            required 
            class="form-control"
            placeholder="employee@example.com"
          >
        </div>

        <div class="form-group">
          <label class="form-label">Phone *</label>
          <input 
            type="tel" 
            [(ngModel)]="newEmployee.phone" 
            name="phone" 
            required 
            class="form-control"
            placeholder="9876543210"
            maxlength="10"
            pattern="[0-9]{10}"
          >
        </div>

        <div class="form-group">
          <label class="form-label">Department *</label>
          <select 
            [(ngModel)]="newEmployee.department" 
            name="department" 
            required 
            class="form-control"
          >
            <option value="">Select Department</option>
            <option value="Development">Development</option>
            <option value="HR">HR</option>
            <option value="Marketing">Marketing</option>
            <option value="Sales">Sales</option>
            <option value="Finance">Finance</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Position *</label>
          <input 
            type="text" 
            [(ngModel)]="newEmployee.position" 
            name="position" 
            required 
            class="form-control"
            placeholder="e.g., Senior Developer"
          >
        </div>

        <div class="form-group">
          <label class="form-label">Join Date *</label>
          <input 
            type="date" 
            [(ngModel)]="newEmployee.join_date" 
            name="join_date" 
            required 
            class="form-control"
          >
        </div>

        <div class="form-group">
          <label class="form-label">Home Address</label>
          <input 
            type="text" 
            [(ngModel)]="newEmployee.home_address" 
            name="home_address" 
            class="form-control"
          >
        </div>

        <div class="form-group">
          <label class="form-label">Status</label>
          <select 
            [(ngModel)]="newEmployee.status" 
            name="status" 
            class="form-control"
          >
            <option value="active">Active</option>
            <option value="on-leave">On Leave</option>
            <option value="inactive">Inactive</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Issued Items</label>
          <input
            type="text"
            [(ngModel)]="newEmployee.issued_items"
            name="issued_items"
            class="form-control"
            placeholder="Laptop, Mouse, Headset"
          />
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-success">
            {{ editingEmployee ? 'Update' : 'Add' }} Employee
          </button>
          <button type="button" class="btn btn-outline" (click)="toggleAddForm()">
            Cancel
          </button>
        </div>
      </form>
    </div>
  }

  <!-- Search Bar -->
  <div class="search-container">
  <input 
    type="text" 
    [(ngModel)]="searchQuery" 
    (input)="searchEmployees()" 
    placeholder="Search by name, email, department, or position..."
    class="form-control search-input"
  >
</div>

  <!-- Employee List -->
  @if (filteredEmployees.length > 0) {
    <div class="employee-grid">
      @for (employee of filteredEmployees; track employee.id) {
        <div class="employee-card">
          <div class="employee-header">
            <h3>{{ employee.name }}</h3>
            <span [class]="'badge badge-' + employee.status" class="status-badge">
              {{ employee.status | titlecase }}
            </span>
          </div>
          
          <div class="employee-info">
            <div class="info-row">
              <span class="info-label">Position:</span>
              <span class="info-value">{{ employee.position }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Department:</span>
              <span class="info-value">{{ employee.department }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Email:</span>
              <span class="info-value">{{ employee.email }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Phone:</span>
              <span class="info-value">{{ employee.phone }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Join Date:</span>
              <span class="info-value">{{ employee.join_date | date: 'dd MMM, yyyy' }}</span>
            </div>
            <div class="info-row">
              <span class="info-label">Home Address:</span>
              <span class="info-value">{{ employee.home_address }}</span>
            </div>
            <div class="info-row" *ngIf="employee.issued_items">
              <span class="info-label">Issued Items:</span>
              <span class="info-value issued-badges">
                <span class="badge badge-info"
                      *ngFor="let item of employee.issued_items.split(',')">
                  {{ item.trim() }}
                </span>
              </span>
            </div>
          </div>
          
          <div class="employee-actions">
            <button class="btn btn-outline" (click)="editEmployee(employee)">
              Edit
            </button>
            <button class="btn btn-danger" (click)="deleteEmployee(employee.id)">
              Delete
            </button>
          </div>
        </div>
      }
    </div>
  } @else {
    <div class="no-results">
      <p>No employees found.</p>
    </div>
  }
</div>
