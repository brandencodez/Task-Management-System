<div class="user-projects-container">

  <!-- HEADER -->
  <div class="header-section">
    <div class="welcome-header">
      <h2>Welcome {{ currentUser || 'User' }}!</h2>
      <p class="subtitle">Your assigned projects and tasks</p>
    </div>

    <button (click)="logout()" class="btn-logout">Logout</button>
  </div>

  <!-- DEPARTMENT -->
  @if (userDepartment) {
    <div class="department-badge">
      <span class="dept-label">Department:</span>
      <span class="dept-name">{{ userDepartment }}</span>
    </div>
  }

  <!-- ðŸ”¹ ROUTED CONTENT (My Projects / Work Entry) -->
  <router-outlet></router-outlet>

  <!-- ðŸ”¹ DEFAULT VIEW: MY PROJECTS -->
  @if (projects.length > 0) {
    <div class="projects-header">
      <h3>Your Projects</h3>
      <span class="project-count">
        {{ projects.length }} project{{ projects.length !== 1 ? 's' : '' }}
      </span>
    </div>

    <div class="projects-grid">
      @for (project of projects; track project.id) {
        <div class="project-card">

          <div class="project-header">
            <h4>{{ project.name }}</h4>
            <span class="status-badge {{ project.status.toLowerCase() }}">
              {{ project.status }}
            </span>
          </div>

          <div class="project-details">
            <p><strong>Type:</strong> {{ project.projectType || 'Not specified' }}</p>

            <div class="client-details">
              <p>
                <strong>Company:</strong>
                {{ project.clientDetails.companyName || 'Not specified' }}
              </p>

              @for (contact of project.clientDetails.contacts; track $index) {
                <p>
                  <strong>Contact {{ $index + 1 }}:</strong>
                  {{ contact.name }}
                  @if (contact.email || contact.phone) {
                    ({{ contact.email || contact.phone }})
                  }
                </p>
              }

              @if (project.clientDetails.address) {
                <p><strong>Address:</strong> {{ project.clientDetails.address }}</p>
              }
            </div>

            <p>
              <strong>Duration:</strong>
              {{ project.startDate }} to {{ project.finishDate }}
            </p>

            <p>
              <strong>Brief:</strong>
              {{ project.projectBrief || 'No brief provided' }}
            </p>
          </div>

        </div>
      }
    </div>
  }

  <!-- EMPTY STATES -->
  @else {
    <div class="no-projects">
      @if (userDepartment) {
        <div class="empty-state">
          <h3>No Projects Assigned</h3>
          <p>No projects assigned to your department ({{ userDepartment }}).</p>
        </div>
      } @else {
        <div class="empty-state">
          <h3>Employee Record Not Found</h3>
          <p>No employee record found for your account.</p>
        </div>
      }
    </div>
  }

</div>
