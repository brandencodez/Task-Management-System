<div class="daily-work-container">

  <!-- SECTION TITLE -->
  <h3 class="section-title">Daily Work Entry</h3>

  <!-- ===== ENTRY FORM ===== -->
  <div class="entry-form">

    <!-- Project -->
    <div class="form-group">
      <label>Project <span class="required">*</span></label>
      <select [(ngModel)]="project">
        <option value="">Select project</option>
        <option *ngFor="let p of assignedProjects" [value]="p.name">
          {{ p.name }}
        </option>
      </select>
    </div>

    <!-- Hours -->
    <div class="form-group">
      <label>Hours Worked <span class="required">*</span></label>
      <input
        type="number"
        placeholder="e.g. 4"
        [(ngModel)]="hours"
        min="0"
        max="24"
        required
      />
    </div>

    <!-- Date -->
    <div class="form-group">
      <label>Date <span class="required">*</span></label>
      <input type="date" [(ngModel)]="date" readonly />
    </div>
    
    <!-- Description -->
    <div class="form-group full-width">
      <label>Work Description <span class="required">*</span></label>
      <textarea
        placeholder="Describe what you worked on today..."
        [(ngModel)]="description"
        required>
      </textarea>
    </div>

    <!-- Attachment Upload -->
    <div class="form-group full-width">
      <label>Attachment <span class="required">*</span></label>
      <div class="file-upload-container">
        <input 
          type="file" 
          id="attachmentInput"
          #attachmentInput
          (change)="onFileSelected($event)"
          accept=".jpg,.jpeg,.png,.pdf,.doc,.docx,.xls,.xlsx,.txt"
          class="file-input"
        />
        <label for="attachmentInput" class="file-label">
          <span *ngIf="!selectedFileName">ðŸ“Ž Choose file (Max 200 MB)</span>
          <span *ngIf="selectedFileName" class="file-selected">âœ… {{ selectedFileName }}</span>
        </label>
      </div>
      <small class="file-hint">Required: Images, PDF, DOC/X, XLS/X, TXT | Max 200 MB</small>
    </div>
 
    <!-- Submit -->
    <div class="form-group full-width">
      <button class="add-btn" (click)="addEntry()">
        âž• Add Work Entry
      </button>
    </div>

  </div>

  <!-- ===== ENTRIES LIST ===== -->
  <div class="entries" *ngIf="entries.length">

    <div class="entry-card" *ngFor="let entry of entries">

      <div class="entry-header">
        <strong>{{ entry.project }}</strong>
         <span class="entry-date">{{ formatDateForDisplay(entry.date) }}</span>
      </div>

      <p class="entry-desc">{{ entry.description }}</p>
      
      <!-- Attachment Display -->
      <div *ngIf="entry.attachment_filename" class="attachment-section">
        <a 
          [href]="getAttachmentUrl(entry.attachment_filename)" 
          target="_blank"
          rel="noopener noreferrer"
          class="attachment-link"
          title="Open attachment"
        >
          ðŸ“Ž {{ getAttachmentName(entry.attachment_filename) }}
        </a>
        <span class="mime-type">{{ entry.attachment_mime_type?.toUpperCase() }}</span>
      </div>

      <div class="actions">
        <button class="delete" (click)="deleteEntry(entry.id)">
          Delete
        </button>
      </div>

    </div>
  </div>

  <!-- EMPTY STATE -->
  <p class="empty-text" *ngIf="!entries.length">
    No work entries yet. Start by adding one above ðŸ‘†
  </p>
</div>